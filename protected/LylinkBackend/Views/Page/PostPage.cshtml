@using LylinkBackend_API.Models
@using System.Text.RegularExpressions
@model PostPage

<!DOCTYPE html>
<html lang="en">
@{
    Regex tableTagRegex = new(@"<table\b[^>]*>", RegexOptions.IgnoreCase);
}

@await Html.PartialAsync("HeadContent", new HeadContent
{
    Description = Model.Description,
    Keywords = Model.Keywords,
    NeedsTableStyling = tableTagRegex.IsMatch(Model.Body),
    NeedsEditorTooling = Model.EditorName != null,
    Title = Model.Title,
})

<body>
    <div id="adblock-background"></div>
    <div id="adblock-popup">
        <p>Hey, it looks like a resource failed to load. If you have an ad-blocker, please turn it off.</p>
        <p>This site will never have ads. Please turn off your ad-blocker so my stylesheets load properly.</p>
        <p>Thank you.</p>
        <button onclick="closePopup()">Close</button>
    </div>
    <div id="page-container">
        @await Html.PartialAsync(nameof(SiteColorToggle), new SiteColorToggle
        {
        })
        <div id="content-wrap">
            <header>
               @await Html.PartialAsync("PageHeader", new PageHeader
               {
                   Name = Model.PageName,
                   ParentCategories = Model.ParentCategories
               })

                @{
                    string updateTime = $"{Model.DateUpdated.Hour}:{Model.DateUpdated.Minute:D2}";
                    string updateDate = $"{Model.DateUpdated.Month}/{Model.DateUpdated.Day}/{Model.DateUpdated.Year}";
                }
                
                <h5>Updated @updateTime on @updateDate</h5>
            </header>
            <div class="container">
                <main>
                    @Html.Raw(Model.Body)
                </main>
            </div>
        </div>
        <footer>
            <p>Copyright 2024, All Rights Reserved</p>
        </footer>

        @if (Model.EditorName != null)
        {
            <script src="js/recogito-polyfills.js" onerror="showAdblockPopup()"></script>
            <script src="js/recogito.min.js" onerror="showAdblockPopup()"></script>
            <script src="js/annotation.js" onerror="showAdblockPopup()"></script>
        }

        <script defer>
            let FF_FOUC_FIX;
        </script>
    </div>
</body>
</html>
